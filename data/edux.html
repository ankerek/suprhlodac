<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs"
 lang="cs" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    Úloha č.1 - TCP Server    [BI-PSI Počítačové sítě]
  </title>

  <meta name="generator" content="DokuWiki snapshot? unknown" />
<meta name="robots" content="index,follow" />
<meta name="date" content="2014-03-24T09:41:26+0100" />
<meta name="keywords" content="uloha1" />
<link rel="search" type="application/opensearchdescription+xml" href="/courses/BI-PSI/lib/exe/opensearch.php" title="BI-PSI Počítačové sítě" />
<link rel="start" href="/courses/BI-PSI/" />
<link rel="contents" href="/courses/BI-PSI/uloha1?do=index" title="Index" />
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="/courses/BI-PSI/feed.php" />
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="/courses/BI-PSI/feed.php?mode=list&amp;ns=" />
<link rel="alternate" type="text/html" title="Plain HTML" href="/courses/BI-PSI/_export/xhtml/uloha1" />
<link rel="canonical" href="https://edux.fit.cvut.cz/courses/BI-PSI/uloha1" />
<link rel="stylesheet" media="all" type="text/css" href="/courses/BI-PSI/lib/exe/css.php?s=all&amp;t=edux&amp;tseed=1392620675" />
<link rel="stylesheet" media="screen" type="text/css" href="/courses/BI-PSI/lib/exe/css.php?t=edux&amp;tseed=1392620675" />
<link rel="stylesheet" media="print" type="text/css" href="/courses/BI-PSI/lib/exe/css.php?s=print&amp;t=edux&amp;tseed=1392620675" />
<script type="text/javascript" charset="utf-8" ><!--//--><![CDATA[//><!--
var NS='';var SIG=' --- //[[chudoja3@fit.cvut.cz|chudoja3]] 2014/03/31 22:13//';var JSINFO = {"id":"uloha1","namespace":""};
//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/exe/js.php?tseed=1392620675" ></script>
<script type="text/javascript" charset="utf-8" src="https://www.google.com/jsapi" ></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/plugins/anketa/scripts/results.js" ></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/plugins/anketa/scripts/anketa.js" ></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/plugins/anketa/scripts/voting.js" ></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/plugins/anketa/scripts/editing_template.js" ></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/plugins/harmonogram/harmonogram.js" ></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/plugins/indexmenu/jsmenu/usrmenu.js" ></script>
<script type="text/javascript" charset="utf-8" src="/courses/BI-PSI/lib/plugins/indexmenu/indexmenu.js" ></script>
<script type="text/javascript" charset="utf-8" ><!--//--><![CDATA[//><!--
var indexmenu_ID='uloha1'
//--><!]]></script>
<script type="text/javascript" charset="utf-8" ><!--//--><![CDATA[//><!--
jQuery.noConflict();

//--><!]]></script>
<script type="text/x-mathjax-config" charset="utf-8" ><!--//--><![CDATA[//><!--
//MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
//MathJax.Hub.Config({  TeX: { equationNumbers: {autoNumber: "all"} } });
MathJax.Hub.Config({
	tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
	TeX: { 
		equationNumbers: {autoNumber: "AMS"},
		extensions: ["AMSmath.js", "AMSsymbols.js"]
	} 
});

//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=default" ></script>

  <link rel="shortcut icon" href="/courses/BI-PSI/lib/tpl/edux/images/favicon-cvut.ico" />

    <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
	var pageTracker = _gat._getTracker("UA-10844012-1");
	pageTracker._trackPageview();
} catch(err) {}
</script></head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="logo">
        <a href="/courses/BI-PSI/"  name="dokuwiki__top" id="dokuwiki__top"  accesskey="h" title="[ALT+H]">BI-PSI Počítačové sítě</a>      </div>
      <div class="tagline">
               </div>
      <div class="pagename">
        [[<a href="/courses/BI-PSI/uloha1?do=backlink" >uloha1</a>]]
      </div>

      <div class="clearer"></div>
    </div>

    
    <div class="bar" id="bar__top">
      <div class="bar-left" id="bar__topleft">
                <form class="button btn_revs" method="get" action="/courses/BI-PSI/uloha1"><div class="no"><input type="hidden" name="do" value="revisions" /><input type="submit" value="Starší verze" class="button" accesskey="o" title="Starší verze [O]" /></div></form>      </div>

      <div class="bar-right" id="bar__topright">
        <form class="button btn_recent" method="get" action="/courses/BI-PSI/uloha1"><div class="no"><input type="hidden" name="do" value="recent" /><input type="submit" value="Poslední úpravy" class="button" accesskey="r" title="Poslední úpravy [R]" /></div></form>        <form action="/courses/BI-PSI/" accept-charset="utf-8" class="search" id="dw__search"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Hledat" class="button" title="Hledat" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>&nbsp;
        <form class="button btn_logout" method="get" action="/courses/BI-PSI/uloha1"><div class="no"><input type="hidden" name="do" value="logout" /><input type="hidden" name="sectok" value="b5086b2c184fbdc281e3e85ccadea566" /><input type="submit" value="Odhlásit se" class="button" title="Odhlásit se" /></div></form>      </div>

      <div class="clearer"></div>
    </div>

        <div class="breadcrumbs">
      <span class="bchead">Historie:</span> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/project/start"  class="breadcrumbs" title="project:start">Ukázkový projekt</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/labs/start"  class="breadcrumbs" title="labs:start">Laboratoře</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/labs/04/start"  class="breadcrumbs" title="labs:04:start">4. Laboratoř - OpenSSL: Asymetrická kryptografie – generování klíčů, elementární operace RSA</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/labs/03/start"  class="breadcrumbs" title="labs:03:start">3. Laboratoř - Blokové šifry a operační módy, implementace v OpenSSL</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/classification/start"  class="breadcrumbs" title="classification:start">Hodnocení</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/certifikace-oracle/registrace/start"  class="breadcrumbs" title="certifikace-oracle:registrace:start">Registrace zájemců o certifikaci Oracle Academy</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/classification/semestralka/b132/start"  class="breadcrumbs" title="classification:semestralka:b132:start">Letní semestr 2013/14 - Inventory</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/start"  class="breadcrumbs" title="start">BI-SI1 - Softwarové inženýrství I</a> <span class="bcsep">&raquo;</span> <a href="/courses/BI-PSI/classification/student/chudoja3/start"  class="breadcrumbs" title="classification:student:chudoja3:start">Chudomský Jan</a> <span class="bcsep">&raquo;</span> <span class="curid"><a href="/courses/BI-PSI/uloha1"  class="breadcrumbs" title="uloha1">Úloha č.1 - TCP Server</a></span>          </div>
    
        <div class="breadcrumbs">
      <span class="bchead">Umístění: </span><a href="/courses/BI-PSI/start"  title="start">BI-PSI - Počítačové sítě</a> &raquo; <a href="/courses/BI-PSI/uloha1"  title="uloha1">Úloha č.1 - TCP Server</a>    </div>
    
  </div>
  
  
  <div id='sidebar'>


<h2><a name="bi-psi" id="bi-psi">BI-PSI</a></h2>
<div class="level2">
<ul>
<li class="level1"><a href="/courses/BI-PSI/classification/student/chudoja3/start" class="wikilink1" title="classification:student:chudoja3:start">Studijní výsledky</a></li>
<li class="level1"><a href="/courses/BI-PSI/student/chudoja3/start" class="wikilink2" title="student:chudoja3:start" rel="nofollow">Osobní namespace</a></li>
</ul>

</div>
<!-- SECTION "BI-PSI" [13-57] -->
<h2><a name="obsah" id="obsah">Obsah</a></h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">
 <a href="/courses/BI-PSI/start" class="wikilink1" title="start">Hlavní stránka</a>
</div></li>
</ul>


<div>

<ul class="idx">
<li class="closed"><div class="li"><a href="/courses/BI-PSI/av/start" class="indexmenu_idx_head">A/V záznam</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/parttime/start" class="indexmenu_idx_head">Kombinované studium</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/annotation/start" class="indexmenu_idx_head">Anotace</a></div></li>
<li class="open"><div class="li"><a href="/courses/BI-PSI/classification/start" class="indexmenu_idx_head">Hodnocení</a></div>
<ul class="idx">
<li class="level2"><div class="li"><a href="/courses/BI-PSI/classification/anketa" class="wikilink1" title="classification:anketa">Hodnocení výuky</a></div></li>
</ul>
</li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/en/start" class="indexmenu_idx_head">BIE-PSI - Computer Networks</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/labs/start" class="indexmenu_idx_head">Laboratorní cvičení</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/lectures/start" class="indexmenu_idx_head">Přednášky</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/news/start" class="indexmenu_idx_head">Aktuality</a></div></li>
<li class="level1"><div class="li"><a href="/courses/BI-PSI/priklady" class="wikilink1" title="priklady">Příklady programů</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/seminars/start" class="indexmenu_idx_head">Prosemináře</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/student?idx=student" class="indexmenu_idx">student</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/teacher/start" class="indexmenu_idx_head">Učitelé</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/team/start" class="indexmenu_idx_head">Týmy</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/tutorials/start" class="indexmenu_idx_head">Cvičení</a></div></li>
<li class="closed"><div class="li"><a href="/courses/BI-PSI/vyuka?idx=vyuka" class="indexmenu_idx">vyuka</a></div></li>
<li class="level1"><div class="li"><a href="/courses/BI-PSI/zkouska" class="wikilink1" title="zkouska">Zkouška</a></div></li>
<li class="level1"><div class="li"><a href="/courses/BI-PSI/uloha1-faq" class="wikilink1" title="uloha1-faq">Úloha č.1 - Chybové kódy</a></div></li>
<li class="level1"><div class="li"><span class="curid"><a href="/courses/BI-PSI/uloha1" class="wikilink1" title="uloha1">Úloha č.1 - TCP Server</a></span></div></li>
<li class="level1"><div class="li"><a href="/courses/BI-PSI/uloha2" class="wikilink1" title="uloha2">Úloha č.2 - UDP Klient</a></div></li></ul>
</div>

</div>
<!-- SECTION "Obsah" [58-] --><div class="funding">
<p>
<a href="/courses/BI-PSI/lib/exe/fetch.php?hash=79c566&amp;media=http%3A%2F%2Fedux.fit.cvut.cz%2F_media%2Foppa.png" class="media" title="http://edux.fit.cvut.cz/_media/oppa.png"><img src="/courses/BI-PSI/lib/exe/fetch.php?hash=79c566&amp;media=http%3A%2F%2Fedux.fit.cvut.cz%2F_media%2Foppa.png" class="media" title="&#039;OPPA/PRAHA/EU&#039;" alt="&#039;OPPA/PRAHA/EU&#039;" /></a>
</p>

<p>
Příprava studijního programu Informatika je podporována projektem financovaným z <a href="http://www.esfcr.cz/" class="urlextern" target="_blank" title="http://www.esfcr.cz/"  rel="nofollow">Evropského sociálního fondu</a> a rozpočtu <a href="http://www.praha.eu/" class="urlextern" target="_blank" title="http://www.praha.eu/"  rel="nofollow"> hlavního města Prahy</a>.
</p>

<p>
Praha &amp; EU: Investujeme do vaší budoucnosti
</p>
</div></div>    <div class="page_with_sidebar">
  
<div class="plugin_translation"><span>Překlady této stránky:</span> <ul>  <li><div class="li"><a href="/courses/BI-PSI//uloha1" class="wikilink1" title="česky">cs</a></div></li>  <li><div class="li"><a href="/courses/BI-PSI//en/uloha1" class="wikilink2" title="English">en</a></div></li></ul></div>
    <!-- wikipage start -->
    <!-- TOC START -->
<div class="toc">
<div class="tocheader toctoggle" id="toc__header">Obsah</div>
<div id="toc__inside">

<ul class="toc">
<li class="level1"><div class="li"><span class="li"><a href="#uloha_c1_-_tcp_server" class="toc">Úloha č.1 - TCP Server</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="#situace" class="toc">Situace</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#obecne_schema_komunikace" class="toc">Obecné schema komunikace</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#struktura_posilanych_zprav" class="toc">Struktura posílaných zpráv</a></span></div>
<ul class="toc">
<li class="level3"><div class="li"><span class="li"><a href="#zpravy_poslane_klientem" class="toc">Zprávy poslané klientem</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#zpravy_poslane_serverem" class="toc">Zprávy poslané serverem</a></span></div></li>
</ul>
</li>
<li class="level2"><div class="li"><span class="li"><a href="#priklad_komunikace" class="toc">Příklad komunikace</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#uzivatelska_jmena_a_hesla" class="toc">Uživatelská jména a hesla</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#pozadavky" class="toc">Požadavky</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#section1" class="toc"></a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#implementacni_poznamky" class="toc">Implementační poznámky</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#testovani" class="toc">Testování</a></span></div>
<ul class="toc">
<li class="level3"><div class="li"><span class="li"><a href="#testovani_klienta" class="toc">Testování klienta</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#testovani_serveru" class="toc">Testování serveru</a></span></div></li>
</ul>
</li>
<li class="level2"><div class="li"><span class="li"><a href="#termin_a_zpusob_odevzdani" class="toc">Termín a způsob odevzdání</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#bodovani" class="toc">Bodování</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#literatura" class="toc">Literatura</a></span></div></li></ul>
</li></ul>
</div>
</div>
<!-- TOC END -->



<h1><a name="uloha_c1_-_tcp_server" id="uloha_c1_-_tcp_server">Úloha č.1 - TCP Server</a></h1>
<div class="level1">

</div>

<h2><a name="situace" id="situace">Situace</a></h2>
<div class="level2">

<p>

Na planetě Mars bylo vypuštěno několik průzkumných robotů. Roboti posílají informace ze senzorů a fotografie okolí na stacionární družici na oběžné dráze. Nastřádané informace jsou později družicí odeslány k Zemi.
</p>

<p>
Bohužel však nejsou roboti na povrchu planety sami. Na komunikační server na družici se neustále kdosi pokouší připojovat, prolámat ochrany a server kompromitovat. Nevíme, zda se jedná o konkurenci nebo o cizí formu života, v každém případě je třeba server chránit a striktně dodržovat komunikační protokol.
</p>

<p>
Implementujte server běžící na družici, který bude od robotů přijímat a ukládat informace.
</p>

</div>

<h2><a name="obecne_schema_komunikace" id="obecne_schema_komunikace">Obecné schema komunikace</a></h2>
<div class="level2">

<p>

Komunikační protokol je postaven nad transportním protokolem TCP. Server naslouchá na portu, který je zvolen v intervalu 3000 až 3999 (včetně). Protokol je textově orientovaný a lze jej vyzkoušet např. pomocí příkazu <code>telnet <em>adresa_serveru</em> 3999</code> (v případě portu 3999).
</p>

<p>
Server očekává, že se k němu budou připojovat jednotliví klienti (roboti). Server si po navázání spojení klientem vyžádá autorizaci a autentizaci robota pomocí hesla. Poté může server přijmout informace ze senzorů a načíst fotografie okolí (pokud ji robot pošle). Po odpojení klienta nebo při porušení pravidel protokolu (detekováno na straně serveru) je spojení ukončeno. Na server se může připojovat více robotů najednou a je třeba je obsloužit tak, aby komunikace s jedním robotem neblokovala komunikaci s jiným robotem.
</p>
<pre class="code">
       Klient                                             Server

                    ---------- connect -----------&#62;
                                                    server si vyžádá zadání
                                                    uživatelského jména
                    &#60;--------- zpráva 200 ---------
robot pošle svoje
uživatelské jméno
                    ---------- zpráva U ----------&#62;
                                                    server si zapamatuje
                                                    zaslané uživatel. jméno
                                                    (v této fázi neprovádí
                                                    žádnou kontrolu
                                                    povolených znaků a délky
                                                    uživatelského jména)
                    &#60;--------- zpráva 201 ---------
robot pošle svoje
heslo
                    ---------- zpráva P ----------&#62;
                                                    server si zkontroluje
                                                    poslané uživatelské
                                                    jméno a heslo.

                                                    Pokud kontrola selhala,
                                                    bude odeslána zpráva
                                                    500 a spojení bude ze
                                                    strany serveru ukončeno.
                    &#60;--------- zpráva 500 ---------
                                                    close()

                                 NEBO

                                                    Pokud prošla kontrola
                                                    bez chyby, bude odeslána
                                                    zpráva 202.
                    &#60;--------- zpráva 202 ---------
Robot může nyní
poslat informace
ze senzorů a odeslat
fotografie okolí.
Lze podeslat libovolný
počet zpráv I a F.
                    ---------- zpráva I ----------&#62;
                                                    Pokud nesedí syntaxe
                                                    zprávy I, bude odeslána
                                                    zpráva 501 a spojení
                                                    bude ukončeno.

                                                    Zpráva je uložena do
                                                    logu, zpátky bude
                                                    odeslána zpráva 202.
                    &#60;--------- zpráva 202 ---------
další zpráva
                    ---------- zpráva I ----------&#62;
                                                    Pokud nesedí syntaxe
                                                    zprávy I, bude odeslána
                                                    zpráva 501 a spojení
                                                    bude ukončeno.

                                                    Zpráva je uložena do
                                                    logu, zpátky bude
                                                    odeslána zpráva 202.
                    &#60;--------- zpráva 202 ---------
a také fotografie
                    ---------- zpráva F ----------&#62;
                                                    Pokud nesedí syntaxe
                                                    zprávy F, bude odeslána
                                                    zpráva 501 a spojení
                                                    bude ukončeno.

                                                    Zpráva F obsahuje
                                                    kontrolní součet,
                                                    ten je třeba
                                                    zkontrolovat. Pokud
                                                    součet nesedí, bude
                                                    odeslána zpráva 300,
                                                    spojení nebude
                                                    ukončeno, zpráva však
                                                    nebude uložena na disk.

                                                    Jinak bude fotografie
                                                    uložena na disk a
                                                    server odešle zprávu
                                                    202.
                    &#60;--------- zpráva 202 ---------
Robot pokračuje
v odesílání zpráv
I a F, nakonec
spojení uzavře.

close()
                                                    Server reaguje
                                                    uzavřením spojení

                                                    close()</pre>
<p>
Spojení musí být ukončeno do 45 sekund, jinak bude ze strany serveru násilně ukončeno (zpráva 502).
</p>

</div>

<h2><a name="struktura_posilanych_zprav" id="struktura_posilanych_zprav">Struktura posílaných zpráv</a></h2>
<div class="level2">

</div>

<h3><a name="zpravy_poslane_klientem" id="zpravy_poslane_klientem">Zprávy poslané klientem</a></h3>
<div class="level3">
<table class="inline">
	<tr class="row0">
		<th class="col0">zpráva</th><th class="col1">význam</th><th class="col2">syntaxe</th>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <strong>U</strong>  </td><td class="col1 leftalign">uživatelské jméno robota  </td><td class="col2">řetězec znaků zakončený <code>\r\n</code> (tj. hexadecimálně 0Dh a 0Ah). Není kladeno žádné omezení na délku nebo obsah tohoto řetězce (nesmí pouze obsahovat <code>\r\n</code>, protože touto sekvencí je zpráva zakončena). </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">  <strong>P</strong>  </td><td class="col1 leftalign">heslo robota              </td><td class="col2">řetězec znaků zakončený <code>\r\n</code> (tj. hexadecimálně 0Dh a 0Ah). Není kladeno žádné omezení na délku nebo obsah tohoto řetězce (nesmí pouze obsahovat <code>\r\n</code>, protože touto sekvencí je zpráva zakončena). Povolená uživatelská jména a hesla jsou uvedena níže. </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign">  <strong>I</strong>  </td><td class="col1 leftalign">informace ze senzorů      </td><td class="col2"><code>INFO </code>&lt;mezera&gt; &lt;libovolný řetězec znaků&gt; <code>\r\n</code> </td>
	</tr>
	<tr class="row4">
		<td class="col0 centeralign">  <strong>F</strong>  </td><td class="col1 leftalign">fotografie okolí          </td><td class="col2"><code>FOTO </code>&lt;mezera&gt; &lt;délka fotografie&gt; &lt;mezera&gt; &lt;data&gt; &lt;kontrolní součet&gt;</td>
	</tr>
</table>

</div>

<h4><a name="poznamky_ke_zprave_i" id="poznamky_ke_zprave_i">Poznámky ke zprávě I</a></h4>
<div class="level4">

<p>

Za klíčovým slovem INFO následuje mezera a poté libovolný řetězec znaků neobsahující <code>\r\n</code>. Tento řetězec nemá omezenou velikost. Zpráva je ukončena sekvencí <code>\r\n</code>.
</p>

<p>
<em>Příklad zprávy I:</em>

</p>
<pre class="code">
INFO Teplotní senzor č.3 se porouchal.\r\n</pre>
</div>

<h4><a name="poznamky_ke_zprave_f" id="poznamky_ke_zprave_f">Poznámky ke zprávě F</a></h4>
<div class="level4">

<p>

Délka fotografie se udává dekadickým zápisem v počtu bytů posílaného obrázku (bez kontrolního součtu). Tolik bytů dat je třeba přijmout a uložit do souboru. Délka musí být kladná nenulová. Délka není shora omezena.
</p>

<p>
Data jsou binární povahy a obsahují fotografii okolí. Tuto fotografii je třeba uložit do souboru (v aktuálním adresáři) s názvem „fotoXXX.png“, kde XXX je libovolné celé číslo od 0 do 999. Po skončení přenosu fotografie nebo po ukončení spojení se musí soubor s fotografií buď vymazat (chybný kontrolní součet, nekompletní přenos) nebo přejmenovat (je-li to nutné) na požadované jméno souboru.
</p>

<p>
Kontrolní součet následuje bezprostředně za koncem posílané fotografie. Jedná se o 4 byty ve formátu Big Endian (nejdříve se posílá nejvýznamnější byte slova). Kontrolní součet spočítáte jako součet všech jednotlivých bytů fotografie.
</p>

<p>
<em>Příklad zprávy F:</em>

</p>
<pre class="code">
FOTO 2775 @xfv8aw**&#60;%#cd^aa ...(celkem 2775 bytů binárních dat) (4 byty kontrolního součtu)</pre>
<p>
<em>Příklad krátké zprávy F pro demonstraci výpočtu kontrolního součtu:</em>

</p>
<pre class="code">
FOTO 8 ABCDEFGH\x00\x00\x02\x24</pre>
<p>

Kontrolní součet je 65+66+67+68+69+70+71+72=548 (hex 224), tj. v binárním zápise v kódování Big Endian: &lt;00h&gt; &lt;00h&gt; &lt;02h&gt; &lt;24h&gt;. V tomto příkladu je zápisem \xHH označen 1 byte s hexadecimální hodnotou HH.
</p>

</div>

<h3><a name="zpravy_poslane_serverem" id="zpravy_poslane_serverem">Zprávy poslané serverem</a></h3>
<div class="level3">
<table class="inline">
	<tr class="row0">
		<th class="col0">zpráva</th><th class="col1">význam</th><th class="col2">syntaxe</th>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <strong>200</strong>  </td><td class="col1 leftalign">požadavek na zadání uživatelského jména  </td><td class="col2 leftalign"><code>200 <em>&lt;mezera&gt;</em> LOGIN \r\n</code>  </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">  <strong>201</strong>  </td><td class="col1 leftalign">požadavek na zadání hesla  </td><td class="col2 leftalign"><code>201 <em>&lt;mezera&gt;</em> PASSWORD \r\n</code>  </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign">  <strong>202</strong>  </td><td class="col1 leftalign">server je připraven přijmout zprávu  </td><td class="col2 leftalign"><code>202 <em>&lt;mezera&gt;</em> OK \r\n</code>  </td>
	</tr>
	<tr class="row4">
		<td class="col0 centeralign">  <strong>300</strong>  </td><td class="col1 leftalign">chybný kontrolní součet  </td><td class="col2 leftalign"><code>300 <em>&lt;mezera&gt;</em> BAD CHECKSUM \r\n</code>  </td>
	</tr>
	<tr class="row5">
		<td class="col0 centeralign">  <strong>500</strong>  </td><td class="col1 leftalign">neplatné uživatelské jméno nebo heslo  </td><td class="col2 leftalign"><code>500 <em>&lt;mezera&gt;</em> LOGIN FAILED \r\n</code>  </td>
	</tr>
	<tr class="row6">
		<td class="col0 centeralign">  <strong>501</strong>  </td><td class="col1 leftalign">chyba syntaxe zprávy I nebo F  </td><td class="col2 leftalign"><code>501 <em>&lt;mezera&gt;</em> SYNTAX ERROR \r\n</code>  </td>
	</tr>
	<tr class="row7">
		<td class="col0 centeralign">  <strong>502</strong>  </td><td class="col1 leftalign">timeout (45 sekund od zahájení spojení)  </td><td class="col2 leftalign"><code>502 <em>&lt;mezera&gt;</em> TIMEOUT \r\n</code>  </td>
	</tr>
</table>

<p>

Po odeslání zprávy 500,501 a 502 je vždy ze strany serveru uzavřeno spojení.
</p>

<p>
Po odeslání zprávy 300 se spojení neukončí, avšak fotografie není uložena do souboru.
</p>

<p>
Zpráva 501 se posílá ihned po detekování chybné syntaxe (např. místo I (INFO) nebo F (FOTO) přijde znak X).
<em>Pozor na telnet, zapsaná řádka je odeslána až po stisku klávesy ENTER.</em>
</p>

</div>

<h2><a name="priklad_komunikace" id="priklad_komunikace">Příklad komunikace</a></h2>
<div class="level2">

<p>

<em>kurzíva</em> = text zobrazený v terminálu při spuštění a po ukončení spojení<br/>

<strong>tučně</strong> = server (družice)<br/>

normálně = klient (robot)<br/>

Sekvence <code>\r\n</code> jsou zobrazeny jako konce řádků.
</p>

<p>
<em>xsmitka@fray1:/home/zam/xsmitka&gt;telnet baryk.fit.cvut.cz 3999<br/>

Trying 147.32.232.173…<br/>

Connected to baryk.fit.cvut.cz.<br/>

Escape character is &#039;^]&#039;.</em><br/>

<strong>200 LOGIN</strong><br/>

Robot Emil cislo 33<br/>

<strong>201 PASSWORD</strong><br/>

1645<br/>

<strong>202 OK</strong><br/>

INFO 2014-02-19 03:34 nefunkční čidlo tlaku<br/>

<strong>202 OK</strong><br/>

INFO 2014-02-19 03:35 blíží se jiný robot<br/>

<strong>202 OK</strong><br/>

INFO 2014-02-19 03:38 jiný robot atakován, získáno čidlo tlaku<br/>

<strong>202 OK</strong><br/>

FOTO 3068 …..3068 bytu dat + 4 byty kontrolního součtu…..<br/>

<strong>202 OK</strong><br/>

<em>^]q<br/>

<br/>

telnet&gt; q<br/>

Connection closed.<br/>

xsmitka@fray1:/home/zam/xsmitka&gt;</em>
</p>

<p>
Komentář: Spojení se v telnetu ukončí Ctrl+] a potom q a ENTER.
</p>

<p>
<em class="u">Jiný příklad:</em>
</p>

<p>
<em>xsmitka@fray1:/home/zam/xsmitka&gt;telnet baryk.fit.cvut.cz 3999<br/>

Trying 147.32.232.173…<br/>

Connected to baryk.fit.cvut.cz.<br/>

Escape character is &#039;^]&#039;.</em><br/>

<strong>200 LOGIN</strong><br/>

Robot Karel<br/>

<strong>201 PASSWORD</strong><br/>

1045<br/>

<strong>202 OK</strong><br/>

INFO 2014-02-19 03:34 nefunkční čidlo tlaku<br/>

<strong>202 OK</strong><br/>

INFOblablabla<br/>

<strong>501 SYNTAX ERROR</strong><br/>

<em>Connection closed by foreign host.<br/>

xsmitka@fray1:/home/zam/xsmitka&gt;</em>
</p>

</div>

<h2><a name="uzivatelska_jmena_a_hesla" id="uzivatelska_jmena_a_hesla">Uživatelská jména a hesla</a></h2>
<div class="level2">

<p>
Jednotliví roboti se musí přihlásit svým jménem a heslem. Protože sonda nemůže znát všechny roboty (někteří mohou být vyrobeni později než sonda), bylo rozhodnuto, že přihlašovací jména a hesla budou mít následující tvar:
</p>

<p>
Uživatelské jméno: <code>Robot</code> <em>&lt;libovolný řetězec neobsahující sekvenci \r\n&gt;</em><br/>

Heslo: <em>&lt;součet ascii hodnot jednotlivých bytů uživatelského jména zapsaných v dekadické formě&gt;</em>
</p>

<p>
Příklad: Robot345 / 674
</p>

</div>

<h2><a name="pozadavky" id="pozadavky">Požadavky</a></h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">
 programuje se pouze serverová část (nikoliv klienti, tedy roboti),
</div></li>
<li class="level1"><div class="li">
 server musí 100% fungovat s klientem na serveru baryk.fit.cvut.cz (viz níže),
</div></li>
<li class="level1"><div class="li">
 klient má možnost navázat se stejným serverem více spojení paralelně i postupně za sebou (bez restartu serveru),
</div></li>
<li class="level1"><div class="li">
 server musí být stabilní a odolný proti neočekávaným vstupům,
</div></li>
<li class="level1"><div class="li">
 program by měl vypisovat alespoň základní informace o svém stavu (např. posílané a přijímané příkazy či odpovědi),
</div></li>
<li class="level1"><div class="li">
 použitý port se zadává jako parametr v příkazové řádce při spuštění klienta (tzn. že hodnota portu není konstantou ve zdrojového kódu), syntaxe viz níže,
</div></li>
<li class="level1"><div class="li">
 server musí vypisovat informace o aktuálně obslouženém klientovi (aby bylo možno říct, komu byla odpověď odeslána),
</div></li>
<li class="level1"><div class="li">
 zdrojový text musí být komentovaný, v hlavičce všech zdrojových textů musí být uveden autor,
</div></li>
<li class="level1"><div class="li">
 povolené programovací jazyky jsou následující: Java, C, C++.
</div></li>
<li class="level1"><div class="li">
 při implementaci pište vše <strong>do jednoho zdrojového souboru</strong>. Tento soubor můžete pojmenovat jakkoliv, avšak s příponou .c, .cpp nebo .java. Tyto soubory <strong>musí být přeložitelné řádkovým překladačem</strong> (gcc/g++/javac). Odevzdává se pouze tento jeden zdrojový kód, neimplementujte tedy nic do dalších souborů mimo něj.
</div></li>
<li class="level1"><div class="li">
 pokud použijete jazyk Java, napište na začátek zdrojového textu <strong><code>package robot</code></strong> a třídu s metodou <em>main</em> pojmenujte <strong>Robot</strong>. Můžete použít připravenou šablonu, která je k dispozici ke stažení mezi <a href="/courses/BI-PSI/priklady" class="wikilink1" title="priklady">příklady programů</a>.
</div></li>
<li class="level1"><div class="li">
 po spuštění si program musí načíst z příkazové řádky číslo portu:
</div></li>
</ul>


</div>
<div class="level4">

<p>
 <code>./robot &lt;port&gt;</code> <br/>

kde <em>&lt;port&gt;</em> je číslo portu, na kterém server naslouchá.
</p>

</div>
<div class="level2">
<ul>
<li class="level1"><div class="li">
 každý student má <strong>povinnost průběžně uploadovat aktuální stav svého zdrojového kódu</strong> přes <acronym title="World Wide Web">WWW</acronym> rozhraní serveru baryk.fit.cvut.cz. Předpokládá se, že vždy po ukončení práce na programu nahrajete svůj kód na server Baryk. Také se předpokládá, že pokud k danému dni není záznam o uploadu Vašeho programu, tak jste na programu tento den nepracoval(a). Jinak řečeno, uploadováním svého programu vykazujete činnost (stejně jako v komerčním prostředí) a zároveň se chráníte před obviněním z nepoctivého jednání (přečtěte si obecné požadavky na úlohy na hlavní stránce předmětu).
</div></li>
</ul>


</div>

<h2><a name="implementacni_poznamky" id="implementacni_poznamky">Implementační poznámky</a></h2>
<div class="level2">
<ul>
<li class="level1"><div class="li">
 <strong>nepoužívejte pro komunikaci metodu <code>PrintStream.println(příkaz)</code>. Zjednodušeně udělá ekvivalent následujícího: <code>print(příkaz + System.getProperty(„line.separator“)</code>, kde line.separator je na různých platformách různý.</strong>
</div></li>
<li class="level1"><div class="li">
 Používejte metody, které znáte a víte přesně, co dělají. BufferedReader.readLine() se pro server opravdu nehodí, viz <a href="http://java.sun.com/javase/6/docs/api/java/io/BufferedReader.html#readLine()" class="urlextern" target="_blank" title="http://java.sun.com/javase/6/docs/api/java/io/BufferedReader.html#readLine()"  rel="nofollow">Javadoc - BufferedReader.readLine()</a>
</div></li>
</ul>


</div>

<h2><a name="testovani" id="testovani">Testování</a></h2>
<div class="level2">

</div>

<h3><a name="testovani_klienta" id="testovani_klienta">Testování klienta</a></h3>
<div class="level3">

<p>
Referenční server pro první úlohu běží na adrese baryk.fit.cvut.cz na portu 3999. Funkčnost serveru lze ověřit zadáním příkazu:<br/>

<code>telnet baryk.fit.cvut.cz 3999</code>
</p>

</div>

<h3><a name="testovani_serveru" id="testovani_serveru">Testování serveru</a></h3>
<div class="level3">

<p>
Testování Vašeho serveru testovacím klientem není možné provádět přímo z učebny (neprojde NATem). Proto bylo na serveru Baryk vyrobeno rozhraní, přes které můžete uploadovat svůj zdrojový kód a Baryk jej:
</p>
<ol>
<li class="level1"><div class="li">
 zaarchivuje
</div></li>
<li class="level1"><div class="li">
 přeloží
</div></li>
<li class="level1"><div class="li">
 spustí v roli serveru
</div></li>
<li class="level1"><div class="li">
 na požádání otestuje
</div></li>
</ol>


<p>

Překlad bude proveden podle použitého jazyka takto:
</p>
<table class="inline">
	<tr class="row0">
		<td class="col0 leftalign">C       </td><td class="col1 leftalign"><code>gcc -o robot source.c -lpthread</code>  </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign">C++     </td><td class="col1 leftalign"><code>g++ -o robot source.c -lpthread</code>  </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign">Java    </td><td class="col1 leftalign"><code>javac source.java</code>  </td>
	</tr>
</table>

<p>

Pokud není Váš počítač schován za NATem, lze v rámci sítě ČVUT využít i testování přes síť. Na webové stránce <a href="http://baryk.fit.cvut.cz/cgi-bin/robottcp" class="urlextern" target="_blank" title="http://baryk.fit.cvut.cz/cgi-bin/robottcp"  rel="nofollow">http://baryk.fit.cvut.cz/cgi-bin/robottcp</a> zadáte IP adresu a port, na kterém běží Vaše implementace serveru. Po odeslání této informace bude Váš server otestován naším klientem. Výsledek bude zobrazen.
</p>

<p>
K dispozici máte <a href="/courses/BI-PSI/uloha1-faq" class="wikilink1" title="uloha1-faq">seznam nejčastějších chyb</a>, které mohou při testování nastat, a jejich popis.
</p>

</div>

<h2><a name="termin_a_zpusob_odevzdani" id="termin_a_zpusob_odevzdani">Termín a způsob odevzdání</a></h2>
<div class="level2">



<p>
Za každý týden prodlení je penalizace -0,5 bodu (jako přelom týdne se počítá konec cvičení). 
</p>

<p>
Odevzdat lze pouze takovou úlohu, která splňuje minimální požadavky (za 0 bodů):
</p>
<ul>
<li class="level1"><div class="li">
 je přeložitelná na serveru baryk.fit.cvut.cz
</div></li>
<li class="level1"><div class="li">
 dokáže přijmout spojení od klienta a přijmout jeho uživatelské jméno)
</div></li>
</ul>


<p>

Postup odevzdání:
</p>
<ol>
<li class="level1"><div class="li">
 otestujte svoje řešení proti klientovi na serveru Baryk
</div></li>
<li class="level1"><div class="li">
 připravte si zdrojové texty k nahlédnutí
</div></li>
<li class="level1"><div class="li">
 připravte si internetový prohlížeč na server Baryk a připravte se na překlad zdrojového kódu
</div></li>
<li class="level1"><div class="li">
 spusťte terminál, nastavte adresář s Vaší úlohou jako aktuální a zadejte příkaz <code>ls -l</code>
</div></li>
<li class="level1"><div class="li">
 zavolejte cvičícího
</div></li>
</ol>


</div>

<h2><a name="bodovani" id="bodovani">Bodování</a></h2>
<div class="level2">

<p>
Za úlohu můžete dostat max. 8 bodů. Penalizace:
</p>
<ul>
<li class="level1"><div class="li">
 server nezpracovává požadavky klienta paralelně: -3
</div></li>
<li class="level1"><div class="li">
 chybně implementovaný protokol: -4
</div></li>
<li class="level1"><div class="li">
 nestabilita: -3
</div></li>
<li class="level1"><div class="li">
 malá odolnost vůči nestandardním vstupům: -3
</div></li>
<li class="level1"><div class="li">
 chyby v programu, které se neprojevily přímo: dle povahy -1 až -5
</div></li>
<li class="level1"><div class="li">
 nečistý zdrojový kód: -1
</div></li>
<li class="level1"><div class="li">
 zdrojový kód nebyl průběžně uploadován na server Baryk: -5
</div></li>
</ul>


</div>

<h2><a name="literatura" id="literatura">Literatura</a></h2>
<div class="level2">

<p>

<a href="http://marsrovers.jpl.nasa.gov/home/index.html" class="urlextern" target="_blank" title="http://marsrovers.jpl.nasa.gov/home/index.html"  rel="nofollow">Průzkumní roboti na Marsu</a><br/>

<a href="http://www.abicko.cz/clanek/vystrihovanky/5447/kosmicky-pruzkumny-robot-spirit.html" class="urlextern" target="_blank" title="http://www.abicko.cz/clanek/vystrihovanky/5447/kosmicky-pruzkumny-robot-spirit.html"  rel="nofollow">Motivační vystřihovánka</a>

</p>

</div>

    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
        Přihlášen(a) jako: chudoja3 (chudoja3)      </div>
      <div class="doc">
        /mnt/www/courses/BI-PSI/data/pages/uloha1.txt &middot; Poslední úprava: 2014/03/24 09:41 autor: xsmitka      </div>
    </div>

   
    <div class="bar" id="bar__bottom">
      <div class="bar-left" id="bar__bottomleft">
                <form class="button btn_revs" method="get" action="/courses/BI-PSI/uloha1"><div class="no"><input type="hidden" name="do" value="revisions" /><input type="submit" value="Starší verze" class="button" accesskey="o" title="Starší verze [O]" /></div></form>      </div>
      <div class="bar-right" id="bar__bottomright">
                                <form class="button btn_logout" method="get" action="/courses/BI-PSI/uloha1"><div class="no"><input type="hidden" name="do" value="logout" /><input type="hidden" name="sectok" value="b5086b2c184fbdc281e3e85ccadea566" /><input type="submit" value="Odhlásit se" class="button" title="Odhlásit se" /></div></form>        <form class="button btn_index" method="get" action="/courses/BI-PSI/uloha1"><div class="no"><input type="hidden" name="do" value="index" /><input type="submit" value="Index" class="button" accesskey="x" title="Index [X]" /></div></form>        <a class="nolink" href="#dokuwiki__top"><input type="button" class="button" value="Nahoru" onclick="window.scrollTo(0, 0)" title="Nahoru" /></a>&nbsp;
      </div>
      <div class="clearer"></div>
    </div>

  </div>

</div>

<div class="footerinc">

  <a target="_blank" href="/courses/BI-PSI/feed.php" title="Recent changes RSS feed"><img src="/courses/BI-PSI/lib/tpl/edux/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" /></a>

  <!-- <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="license" title="Creative Commons License"><img src="/courses/BI-PSI/lib/tpl/edux/images/button-cc.gif" width="80" height="15" alt="Creative Commons License" /></a> -->

  <!-- <a target="_blank" href="https://www.paypal.com/xclick/business=andi%40splitbrain.org&amp;item_name=DokuWiki+Donation&amp;no_shipping=1&amp;no_note=1&amp;tax=0&amp;currency_code=EUR&amp;lc=US" title="Donate"><img src="/courses/BI-PSI/lib/tpl/edux/images/button-donate.gif" alt="Donate" width="80" height="15" /></a>-->

  <a target="_blank" href="http://www.php.net" title="Powered by PHP"><img src="/courses/BI-PSI/lib/tpl/edux/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="/courses/BI-PSI/lib/tpl/edux/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="/courses/BI-PSI/lib/tpl/edux/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="/courses/BI-PSI/lib/tpl/edux/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>



<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->


</div>

<div class="no"><img src="/courses/BI-PSI/lib/exe/indexer.php?id=uloha1&amp;1396296821" width="1" height="1" alt=""  /></div>
</body>
</html>
